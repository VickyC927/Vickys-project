<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>個人消費行為分析｜消費視覺化分析專案</title>
  <style>
    :root{
      --c1:#D3DF92; /* 漸層起點 */
      --c2:#F8C59E; /* 漸層終點 & 重點色 */
      --c3:#FCDEC3; /* 輔助底色 */
      --text:#2c3e50;
    }

    body {
      font-family: "Segoe UI", "Noto Sans TC", sans-serif;
      background-color: #f9f9fb;
      color: var(--text);
      margin: 0;
      padding: 0;
    }

    header {
      background: linear-gradient(to right, var(--c1), var(--c2));
      color: white;
      text-align: center;
      padding: 50px 20px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      transition:
        transform 0.8s ease,
        opacity 0.8s ease,
        background 0.3s ease,
        filter 0.3s ease;
    }

    header h2 { margin: 0; font-size: 28px; }

    main {
      max-width: 960px;
      margin: 40px auto;
      padding: 0 20px;
    }

    section {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      opacity: 0;
      transform: translateY(40px);
      transition: all 0.7s ease-out;
    }

    section.show { opacity: 1; transform: translateY(0); }

    h3 {
      margin-top: 0;
      border-left: 5px solid var(--c2);
      padding-left: 10px;
      color: #34495e;
    }

    ul, ol { margin-left: 20px; }

    li {
      margin-bottom: 6px;
      transition: transform 0.3s ease, color 0.3s ease;
    }
    li:hover { transform: scale(1.02); color: var(--c2); }

    /* RWD 內嵌容器（Power BI / PPT 共用） */
    .embed-wrap {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;       /* 預設 16:9；Power BI 我們用 1918/1005 也差不多 */
      border-radius: 10px;
      overflow: hidden;
      background-color: var(--c3);
      opacity: 0;
      transform: scale(0.95);
      transition: opacity 0.8s ease, transform 0.8s ease, box-shadow 0.3s ease;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
    }
    .embed-wrap.show { opacity: 1; transform: scale(1); }
    .embed-wrap:hover { box-shadow: 0 6px 20px rgba(0,0,0,0.12); }

    .embed-wrap iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    footer { text-align: center; padding: 30px; color: #888; font-size: 14px; }
  </style>
</head>
<body>
  <header>
    <h2>你花錢的樣子像誰？｜消費視覺化分析專案</h2>
  </header>

  <main>
    <section>
      <h3>專案簡介</h3>
      <p>
        本專案結合個人電子發票與信用卡消費資料，並搭配政府家庭收支調查等公開數據，
        透過 Power BI 建立互動式視覺化儀表板，分析個人與群體的消費結構差異，探索消費行為背後的風格特徵。
      </p>
    </section>

    <!-- 新增：PPT 嵌入區（放在簡介與互動展示之間） -->
    <section>
      <h3>專案簡報（PPT）</h3>
      <div class="embed-wrap" id="ppt-wrap">
        <iframe id="pptFrame" title="專案簡報"></iframe>
      </div>
      <p style="margin-top:12px;color:#777;font-size:14px;">
        若無法載入，請確認檔案已設為「任何人擁有連結可檢視」，或<a href="#" id="pptDirectLink">改用直接連結開啟</a>。
      </p>
    </section>

    <!-- 互動展示（Power BI） -->
    <section>
      <h3>互動展示（Power BI）</h3>
      <div class="embed-wrap">
        <iframe 
          title="個人消費分析_江梓瑀" 
          src="https://app.powerbi.com/view?r=eyJrIjoiNDE0YjUyNmQtOWFhYS00M2FmLWE3ODYtMzE0OTg3ZGQyYjVmIiwidCI6IjhlODY2MWQyLTY3OTAtNDI2NC05NDIxLTFiODM2NDVjMmVlZCJ9" 
          allowFullScreen="true">
        </iframe>
      </div>
    </section>

    <section>
      <h3>分析面向</h3>
      <ol>
        <li><strong>消費行為分析</strong>
          <ul>
            <li>自動分類消費項目（如食、衣、住、行、育樂、其他）</li>
            <li>分析消費金額、次數、時間分布、商家偏好</li>
          </ul>
        </li>
        <li><strong>個人 vs 群體比較</strong>
          <ul>
            <li>引入全台平均、學生、上班族等族群作對照</li>
            <li>計算消費佔比差異，建立比較雷達圖與象限圖</li>
          </ul>
        </li>
        <li><strong>年度與月份趨勢追蹤</strong>
          <ul>
            <li>比較不同年份、月份的總花費與消費組成變化</li>
            <li>加入四季、月份等時間維度，觀察消費高峰期</li>
          </ul>
        </li>
        <li><strong>視覺化儀表板</strong>
          <ul>
            <li>使用 Power BI 製作互動圖表</li>
            <li>包含趨勢圖、佔比圖、象限圖與 Tooltip 功能</li>
          </ul>
        </li>
      </ol>
    </section>

    <section>
      <h3>資料來源</h3>
      <ul>
        <li>個人電子發票資料（財政部）</li>
        <li>信用卡消費明細</li>
        <li>政府公開資料（家庭收支調查、物價指數等）</li>
      </ul>
    </section>

    <section>
      <h3>預期效益</h3>
      <ul>
        <li>認識自身的消費習慣與偏好分類</li>
        <li>與群體比較，發現潛在的消費風格特徵</li>
        <li>提升財務自覺與資料閱讀能力</li>
      </ul>
    </section>

    <section>
      <h3>使用工具</h3>
      <ul>
        <li>Python（資料前處理、自動分類）</li>
        <li>SQL / Power Query（資料整合與轉換）</li>
        <li>Power BI（互動式視覺化）</li>
        <li>Excel / Google Sheets（初步彙整）</li>
      </ul>
    </section>
  </main>

  <footer>
    &copy; 2025 智慧消費視覺化分析專案 ｜ Designed with ❤️
  </footer>

  <script>
    // Header 漸層視差與亮度變化
    const header = document.querySelector('header');
    window.addEventListener('scroll', () => {
      const scrollY = window.scrollY;
      const offset = scrollY * 0.2; // 視差速度
      const brightness = Math.max(0.85, 1 - scrollY / 800); // 最低亮度 85%
      header.style.background = `linear-gradient(to right, var(--c1) ${offset}px, var(--c2))`;
      header.style.filter = `brightness(${brightness})`;
    });

    // 進場動畫（區塊/內嵌）
    const targets = document.querySelectorAll('section, .embed-wrap');
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('show'); });
    }, { threshold: 0.2 });
    targets.forEach(el => observer.observe(el));

    // 🧩 動態設定 PPT 來源（用 encodeURIComponent 自動編碼）
    const rawPptUrl = "https://913002-my.sharepoint.com/:p:/r/personal/chiang_913002_onmicrosoft_com/Documents/%E5%B0%88%E9%A1%8C/%E5%80%8B%E4%BA%BA%E6%B6%88%E8%B2%BB%E5%88%86%E6%9E%90_%E6%B1%9F%E6%A2%93%E7%91%80.pptx?d=we2b17c04134841d68ddd89714eaf3a89&csf=1&web=1&e=PXUdhZ";
    const pptEmbed = "https://view.officeapps.live.com/op/embed.aspx?src=" + encodeURIComponent(rawPptUrl);
    const pptFrame = document.getElementById("pptFrame");
    const pptDirectLink = document.getElementById("pptDirectLink");
    if (pptFrame) pptFrame.src = pptEmbed;
    if (pptDirectLink) pptDirectLink.href = rawPptUrl;
  </script>
</body>
</html>
